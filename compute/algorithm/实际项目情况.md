# 实际项目情况
 
## 光伏布线  
包括 ： 从光伏板至汇流箱的散线，汇流箱至总接线箱的电缆，35kV电缆连接方式
 前两者为等权重路径选择问题，且需要遵循尽量少的对地面的线开槽开孔；
 35kV电缆连接方式，则是和海上风电电缆一样的不同权重问题，具体见海上风电；
  
## 海上风电电缆
海上风电电缆布置选优，此情况下，主要为多分支连接，分支内部主要是串行连接，最多不超过二叉分支，且越靠近终点电站的路径电缆直径价格都有较大涨幅；
为分权重路径问题；
 
## 分权重路径问题部分边界条件：
单线设备总荷载小于30MW
单设备点进出口仅支持三个或以下

## 采用算法
退火算法   蚂蚁算法    遗传算法  聚类算法   最小数算法   混合算法
概率选最优 

> 等权重问题只是分权重问题的简化版本

*注意事项:
在进行三维布置考虑时，需要对每一段路径一定间隔进行采样，得到采样点的空间坐标，且需要对地面进行或者海底地向进行采样，获得采样点，并在迭代线采样点的时候找寻最近采样点高度进行比对，从而计入长度修正计算中；


## 预设规定
首先根据边界条件和系统计算性能考虑进行部分预先规定：

经济适应范围：
点位个数 N  ， 每米最高规格电缆价格P，计算得接近最高费用为 $P_{top}= N×P$ 
故计算获得适应范围为 $(0,P_{top})$  

分支情况考虑：
每次计算出现的个体都需要经过“进出口数量过滤器”，不符合的可直接淘汰，或给予适应性依据超过数打折扣；

高度问题考虑：
将电缆规格及单价记录到DB文件或excel内，使用时预先读入内存；
将点位成对路径起终点和等间距采样点空间坐标配，记入DB文件POINT_LINE；
将地面表面坐标进行均匀采样，采样点空间坐标计入DB文件POINT_LAND；
将POINT_LINE 中每个点 和 POINT_LAND 中最近点配对，形成新对应表，使用时预读入内存； （该操作适用于地面不平整情况，若地面平整可忽略Z轴对线长影响）

## 若使用混合算法过程
混合算法是三种算法的混合
包括：模糊聚类，Delaunay三角剖分，最小树Prim或Kruskal；

使用模糊聚类FCM算法，将整个区域划分为多个子区域
使用Delaunay三角剖分，获得单一子区域的所有点不交叉且距离最近的连线
使用最小树，获得单一子区域内所有连线的最短距离，形成树状路径

### 1 模糊聚类FCM
注意 FCM对于初始化的点有一定依赖，此步骤需要对FCM多次进行计算选优；

FCM来源于K均值算法：
定义总共簇的数量
将簇中心随机定在一个点上
将美国各数据关联到最近簇的中心所属的簇上
对每个簇找到所有关联点的中心点
将上述点（均值的中性点）变为新簇心
不同重复直到所有簇的点不变

FCM 模糊C均值算法引入了归属度和欧式距离为加权值的乘积
**步骤1：** 用值在0，1间的随机数初始化隶属矩阵U，使其满足式（6.9）中的约束条件，需要进行归属度归一化,所有点归属度和是1；
![[Pasted image 20210918161345.png]]
**步骤2：** 用式（6.12）计算c个聚类中心ci，i=1,…,c  
![[Pasted image 20210918161327.png]]
**步骤3：** 根据式（6.10）计算价值函数，将归属度和欧式距离乘积；
如果它小于某个确定的阀值，或它相对上次价值函数值的改变量小于某个阀值，则算法停止； 
![[Pasted image 20210918161359.png]]
**步骤4：** 用（6.13）计算新的U矩阵，将归属度重新调整；返回步骤2。
![[Pasted image 20210918161415.png]]

### 2 Delaunay三角剖分
三角剖分严格来说不是一种算法，只能给出一个好的三角网格的定义，它的优秀特性是空圆特性和最大化最小角特性，这两个特性避免了狭长三角形的产生，也使得Delaunay三角剖分应用广泛；
它的优秀特性是空圆特性和最大化最小角特性，这两个特性避免了狭长三角形的产生，也使得Delaunay三角剖分应用广泛；

![[Pasted image 20210918094939.png]]
假如以AC来剖分四边形ABCD，这里B点在三角形ACD的外接圆内，D点在三角形ABC的外接圆内，所以不具有空圆特性；

![[Pasted image 20210918095119.png]]
以BD来剖分四边形ABCD，C点不在三角形ABD的外接圆内，A点也不在三角形BCD的外接圆内，具有空圆特性，而且它的最小角要比不满足空圆特性的最小角大； 



### 3 最小树
主要有prime以及kruskal两种算法可选

 
 
 
 #
#
## 若选用遗传算法的基本过程
 此时我们为了较全面的覆盖各类复杂工程情况；采用不同权重的布线情况，等权重算法是其功能子集；
 
### 1 点位处理
将汇聚点标记为0；
读取实际工程的实际点位，将点位从1开始整数编号，构造矩阵，形成点的两两配对，并在点矩阵中记录该线长度（此处注意如果地面不平整，需要引入地面采样或向下寻找等步骤），此时获得了点到点线路的长度矩阵；之后的所有计算都从矩阵内直接获得，无需查表等步骤；

### 2 编码方案
由于所有布线路径都是，多个点对组成路径，多个路径组成一个方案个体，故最终需要比对的是方案个体的总成本，故采用 ；

### 3 随机初始化
汇聚点不限入度；
不同线路之间禁止交叉；
从第一个某随机点A经过各种点连接到汇聚点，记录所有点对（注意负荷或个数限制），并将长度记录，再从第二个随机点出发随机经过接口数少于3的点连接到汇聚处，直到所有点都至少有一个出口为止，该路径集合为一个个体；
这样一个随机点可以生成一个样本；
那么一个随机点可以生成几个不同的样本，内部的一条路径作为其一个基因编码；
同样更换一个随机点可以做同样操作；
将对组不同的样本合成一个初始的随机样本群体；
推荐数量约300；
注意：如果是光伏选线过程仅仅从一个点出发即可；

### 4 解码获得分数
对每个样本进行计算
由于此处采用了非等权重的路径计算方法，对每个样本内的每一个路径做成本核算；

其计算方法为从路径荷载W以及电压V计算获得其每段的载流量A，根据载流量比较电缆规格表向上选取规格获得其长度单价，并计算路径成本；

获得本世代所有样本的成本；


### 5 适应性函数

将一个样本内的多组路径成本获得之后和与设定的范围$(0,P_{top})$  比较，并提高最小成本样本的得分
 
### 6 择优方式
得到了样本的分数之后，首先保留最好及最坏的各1成，淘汰较不合适的1成，剩余使用轮盘方式进行择优；
最后获得原总样本量的一半样本数；

注意接下来的编译和子代可以二选一也可都进行；由于其路径特殊性，推荐直接进行克隆并变异；

### 7 基因变异
一个样本内对组线路，改变线路内

### 8 产生子代

将择优获得的样本进行编码交换，产生子代，由于每个线路是一个编码，交换部分线路情况会影响到其他点位的出入度；
故不进行全线交换，进行部分相同点对的路线交换，产生子代，并在此处添加新子代淘汰机制，若有交叉线进行则存活率减低；



