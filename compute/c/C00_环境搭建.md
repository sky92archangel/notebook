# 环境搭建

[TOC]

## windows系统

这里教程采用GCC作为编译器，为了跨平台不建议使用MSVC

windows的配置较为繁琐

下载MinGW-W64

```html
https://sourceforge.net/projects/mingw-w64/files/mingw-w64/mingw-w64-release/
```

下载的压缩包一般为

```SHELL
x86_64-13.2.0-release-win32-seh-ucrt-rt_v11-rev1.7z
```

>  异常处理模式：seh较新且高效但是不支持32系统，32则采用sjlj且稳定;
>
> 系统类型：windows上采用win32，而unix。macos，linux及其他采用posix

解压该文件到

```shell
C:\DEV\mingw64
```

分别得到多个文件夹，比较主要的如下

```
C:\DEV\mingw64\bin
C:\DEV\mingw64\include
C:\DEV\mingw64\lib
```

为了终端在各个目录可用编译器，系统变量PATH中添加路径

```
C:\DEV\mingw64\bin
```

然后打开命令行终端输入，成功就会又一堆提示

```shell
$ gcc -v
Using built-in specs.
COLLECT_GCC=C:\DEV\mingw64\bin\gcc.exe
COLLECT_LTO_WRAPPER=C:/DEV/mingw64/bin/../libexec/gcc/x86_64-w64-mingw32/13.2.0/lto-wrapper.exe
Target: x86_64-w64-mingw32
Configured with: ../../../src/gcc-13.2.0/configure --host=x86_64-w64-mingw32 --build=x86_64-w64-mingw32 --target=x86_64-w64-mingw32 --prefix=/mingw64 --with-sysroot=/c/buildroot/x86_64-1320-win32-seh-ucrt-rt_v11-rev1/mingw64 --enable-host-shared --disable-multilib --enable-languages=c,c++,fortran,lto --enable-libstdcxx-time=yes --enable-threads=win32 --enable-libstdcxx-threads=yes --enable-libgomp --enable-libatomic --enable-lto --enable-graphite --enable-checking=release --enable-fully-dynamic-string --enable-version-specific-runtime-libs --enable-libstdcxx-filesystem-ts=yes --disable-libssp --disable-libstdcxx-pch --disable-libstdcxx-debug --enable-bootstrap --disable-rpath --disable-win32-registry --disable-nls --disable-werror --disable-symvers --with-gnu-as --with-gnu-ld --with-arch=nocona --with-tune=core2 --with-libiconv --with-system-zlib --with-gmp=/c/buildroot/prerequisites/x86_64-w64-mingw32-static --with-mpfr=/c/buildroot/prerequisites/x86_64-w64-mingw32-static --with-mpc=/c/buildroot/prerequisites/x86_64-w64-mingw32-static --with-isl=/c/buildroot/prerequisites/x86_64-w64-mingw32-static --with-pkgversion='x86_64-win32-seh-rev1, Built by MinGW-Builds project' --with-bugurl=https://github.com/niXman/mingw-builds CFLAGS='-O2 -pipe -fno-ident -I/c/buildroot/x86_64-1320-win32-seh-ucrt-rt_v11-rev1/mingw64/opt/include -I/c/buildroot/prerequisites/x86_64-zlib-static/include -I/c/buildroot/prerequisites/x86_64-w64-mingw32-static/include' CXXFLAGS='-O2 -pipe -fno-ident -I/c/buildroot/x86_64-1320-win32-seh-ucrt-rt_v11-rev1/mingw64/opt/include -I/c/buildroot/prerequisites/x86_64-zlib-static/include -I/c/buildroot/prerequisites/x86_64-w64-mingw32-static/include' CPPFLAGS=' -I/c/buildroot/x86_64-1320-win32-seh-ucrt-rt_v11-rev1/mingw64/opt/include -I/c/buildroot/prerequisites/x86_64-zlib-static/include -I/c/buildroot/prerequisites/x86_64-w64-mingw32-static/include' LDFLAGS='-pipe -fno-ident -L/c/buildroot/x86_64-1320-win32-seh-ucrt-rt_v11-rev1/mingw64/opt/lib -L/c/buildroot/prerequisites/x86_64-zlib-static/lib -L/c/buildroot/prerequisites/x86_64-w64-mingw32-static/lib ' LD_FOR_TARGET=/c/buildroot/x86_64-1320-win32-seh-ucrt-rt_v11-rev1/mingw64/bin/ld.exe --with-boot-ldflags=' -Wl,--disable-dynamicbase -static-libstdc++ -static-libgcc'
Thread model: win32
Supported LTO compression algorithms: zlib
gcc version 13.2.0 (x86_64-win32-seh-rev1, Built by MinGW-Builds project)

```

此时环境配置完成

补充动作，可以在make时候简化输入

```shell
cp C:\DEV\mingw64\bin\mingw32-make.exe C:\DEV\mingw64\bin\make.exe 
```

此时输入make则出现

```shell
$ make -v
GNU Make 4.4.1
Built for x86_64-w64-mingw32
Copyright (C) 1988-2023 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <https://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

```





## linux环境

这个命令会安装较为全面的编译环境

```shell
sudo apt-get install build-essential
```

当然如果要单独安装gcc也可以

```shell
sudo apt-get install gcc
```





## macos环境

```shell
brew install gcc
```

MACOS商业也有xcode集成工具，用的是clang；







## vscode

安装vscode ，略

安装C/C++扩展，略

安装code runner扩展，略

创建测试程序文件hello.c

```c
#include <stdio.h> 
int main(void){ 
    printf("HELLO\n"); 
    return 0;
} 
```

F5运行，选择GDB/LLDB，此时可能会运行，并在当前目录产生.vscode文件夹，其中会有一个task.json文件（有时候是launch.json）task.json定义构建任务，而launch.json定义调试配置；

不过建议自己创建；

launch.json

```json
{
    // 使用 IntelliSense 了解相关属性。 
    // 悬停以查看现有属性的描述。
    // 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [ 
        {
            "name": "(gdb) 启动",
            "type": "cppdbg",
            "request": "launch",
            "program": "${fileDirname}/${fileBasenameNoExtension}.exe",
            "args": [],
            "stopAtEntry": false,
            "cwd": "${fileDirname}",
            "environment": [],
            "externalConsole": false,
            "MIMode": "gdb",
            "miDebuggerPath": "C:/DEV/mingw64/bin/gdb.exe",//gdb路径
            "preLaunchTask": "debugTask", //预编译
            "setupCommands": [
                {
                    "description": "为 gdb 启用整齐打印",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                },
                {
                    "description": "将反汇编风格设置为 Intel",
                    "text": "-gdb-set disassembly-flavor intel",
                    "ignoreFailures": true
                }
            ],
        } 
    ]
}
```

ctrl+shift+p打开面板，选择 tasks: configure default build task 创建 task.json

```json
{ 
    "tasks": [
        {
            "type": "cppbuild",
            "label": "debugTask",//必须和launch中的预编译一样，预编译时就会执行此处
            "command": "C:/DEV/mingw64/bin/gcc.exe",//编译器路径
            "args": [
                "-fdiagnostics-color=always",
                "-g",
                "${file}",
                "-o",
                "${fileDirname}/${fileBasenameNoExtension}.exe"//和launch中一致
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "调试器生成的任务。compiler:  C:/DEV/mingw64/bin/gcc.exe"
        }
    ],
    "version": "2.0.0"
}
```

### 补充

安装插件code runner后，可以在单个程序文件，右键点击run code 直接运行代码；



## 总结

其实鉴于windows环境配置比较复杂，建议win用户采用windows中安装虚拟机linux，并在linux中配置环境，然后采用vscode的remote-ssh扩展远程链接到linux进行开发；





