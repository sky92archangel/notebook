# 常微分方程解

[TOC]

## 隐式函数均值定理转常微分方程

隐式函数转常微分方程
$$
u(x,y)=C,C为任意常数,注意式子内只有x为自变量，这是个隐式函数表达 
\\
\Delta u(x,y)=u(x+\Delta x,y+\Delta y)-u(x,y)=0
\\
u(x+\Delta x,y+\Delta y)-u(x,y+\Delta y) + u(x+\Delta x,\Delta y)-u(x,y)=0
\\
\frac{\part u(x,y)}{\part x}\Delta x +\frac{\part u(x,y)}{\part y}\Delta y=0
\\
du(x,y)=\frac{\part u(x,y)}{\part x}d x +\frac{\part u(x,y)}{\part y}d y=0
\\
M(x,y)=\frac{\part u(x,y)}{\part x},N(x,y)=\frac{\part u(x,y)}{\part y}
\\
du(x,y)=M(x,y)dx +N(x,y)dy=0 \to M(x,y)+N(x,y)\frac{dy}{dx}=0
$$


## 正合微分方程 Exact Differential Equation

$$
有一个原函数u(x,y)=C，有二阶连续偏导
\\
得到一个M(x,y)dx +N(x,y)dy=0,猜测M,N是否为原函数的偏导
\\
只需要
\frac{\part M}{\part y}=\frac{\part N}{\part x},即可确认方程可以有原函数形式的解
\\
此类方程式为正合方程式
$$

若发现不相等，说明过程中不只是做了微分，可能还销项了；



### 解正合方程

$$
已有正合微分方程M(x,y)dx +N(x,y)dy=0\\
M(x,y)=\frac{\part u(x,y)}{\part x},N(x,y)=\frac{\part u(x,y)}{\part y}
\\
M(x,y)\part x=\part u(x,y),N(x,y)\part y=\part u(x,y)
\\
\int M(x,y)\part x+g(y)=\int \part u(x,y)=u(x,y) \to u(x,y)=\int M(x,y)\part x+g(y)
\\
\int N(x,y)\part y+f(x)=\int \part u(x,y)=u(x,y) \to u(x,y)=\int N(x,y)\part x+f(x)
\\
最后比较两式，确定g(y),f(x)
$$

 总之，先判断M和N，两者交叉微分后比较是否相等判断是否正合，如果正合，那么就积分得到结果，并比较；





## 非正合微分方程


$$
\frac{\part M}{\part y} \neq \frac{\part N}{\part x}
\to 非正合，说明过程中有消元动作
\\
为了取消影响，需要加上 积分因子I(x,y) (Integrating Factor) ，使得其成为正合方程
\\
I(x,y)M(x,y)dx+I(x,y)N(x,y)dy=0
\\
\frac{\part [I(x,y)M(x,y)]}{\part y} = \frac{\part [I(x,y)N(x,y)]}{\part x}
\to 
I\frac {\part M}{\part y}+M\frac {\part I}{\part y}=I\frac {\part N}{\part x}+N\frac {\part I}{\part x}
\\
I(\frac {\part M}{\part y}-\frac {\part N}{\part x})=N\frac {\part I}{\part x}-M\frac {\part I}{\part y}
$$
  将非正合加上积分因子之后，需要解一阶偏微分方程，采用一个辅助方程
$$
-\frac{dx}{N}=\frac{dy}{M}=\frac{dI}{I(\frac{\part N}{\part x}-\frac{\part M}{\part y})}
$$
接下来不断尝试



### 因子只和x相关

$$
-\frac{dx}{N}=\frac{dI}{I(\frac{\part N}{\part x}-\frac{\part M}{\part y})}
\to
\frac{\frac{\part N}{\part x}-\frac{\part M}{\part y}}{-N}dx=\frac 1I dI=f(x)dx 
\\
\int f(x)dx=\int \frac 1I dI
\to 
I=e^{\int f(x)dx}
$$



### 因子只和y相关

$$
\frac{dy}{M}=\frac{dI}{I(\frac{\part N}{\part x}-\frac{\part M}{\part y})}
 \to 
\frac{\frac{\part N}{\part x}-\frac{\part M}{\part y}}{M}dy=\frac 1I dI=f(y)dy
\\
\int f(y)dy=\int \frac 1I dI
\to 
I=e^{\int f(y)dy}
$$

### 因子和x+y相关

$$
\frac{d(x+y)}{-N+M} =\frac{dI}{I(\frac{\part N}{\part x}-\frac{\part M}{\part y})}
 \to 
\frac{\frac{\part N}{\part x}-\frac{\part M}{\part y}}{-N+M}d(x+y)=\frac 1I dI=f(x+y)d(x+y)
\\
\int f(x+y)d(x+y)=\int \frac 1I dI
\to 
I=e^{\int f(x+y)d(x+y)}
$$







### 因子和xy相关

$$
d(xy)=ydx+xdy
\\
\frac{yd(x)}{-yN} =\frac{xd(y)}{xM} =\frac{dI}{I(\frac{\part N}{\part x}-\frac{\part M}{\part y})}
\\
\frac{yd(x)+xd(y)}{-yN+xM}= \frac{ d(xy) }{-yN+xM} =\frac{dI}{I(\frac{\part N}{\part x}-\frac{\part M}{\part y})}
\\
\int  \frac{ (\frac{\part N}{\part x}-\frac{\part M}{\part y}) }{-yN+xM}d(xy) = \int f(xy)d(xy)=\int f(xy)d(xy)=\int \frac 1I dI
\to 
I=e^{\int f(xy)d(xy)}
$$









然后代回原方程，按照正合方程解下去就可以；



## 总结推论

一阶常微分方程
$$
\dot y +p(x)y=r(x)
\\
r(x)=0,Homogeneous(齐次)
\\
r(x)\neq0,Nonhomogenous(非齐)
$$

### 齐次

$$
\dot y +p(x)y=0
\\
\frac{dy}{dx}+p(x)y=0
\\
p(x)dx=-\int \frac1{y} dy
\\
\int p(x)dx+k=-\int\frac1{y} dy
\\
\ln y=-\int p(x)dx+k
\\
y=e^k e^{-\int p(x)dx}=C e^{-\int p(x)dx}
$$

 

### 非齐


$$
\dot y +p(x)y=r(x)
\\
 [yp(x)-r(x) ]dx + dy = 0
\\
 M = yp(x)-r(x) , N = 1
\\
 \frac{\part N}{\part x}\neq \frac{\part M}{\part y}
\\
 \frac{\part N}{\part x}-\frac{\part M}{\part y} = -p(x)
\\
-\frac{dx}{N}=\frac{dI}{I(\frac{\part N}{\part x}-\frac{\part M}{\part y})}
\\
 \frac{p(x)}{N}dx= \frac{dI}{I}\to \int p(x)dx=\int \frac{dI}{I}\to I = e^{\int p(x)dx}
 \\
  \frac{\part IN}{\part x}= \frac{\part IM}{\part y}
$$
此时得到了因子
$$
u_x =\part IM\part x \to u = \int  \part IM\part x +f(y)
\\
u_y =\part IN\part y \to u = \int  \part IN\part y +g(x)
\\
u_m = ye^{\int p(x)dx}-\int e^{\int p(x)dx}+f(y)
\\
u_n =  ye^{\int p(x)dx}+g(x)

\\
u= ye^{\int p(x)dx}-\int e^{\int p(x)dx}r(x)dx=C
\to 
y=Ce^{-\int p(x)dx}+e^{-\int p(x)dx}\int e^{\int p(x)dx }r(x)dx
$$


那么
$$

\dot y +p(x)y=r(x) \to 

y=Ce^{-\int p(x)dx}+e^{-\int p(x)dx}\int e^{\int p(x)dx }r(x)dx
\\
Ce^{-\int p(x)dx} 为齐次解y_h(x)
\\
e^{-\int p(x)dx}\int e^{\int p(x)dx }r(x)dx 为特解y_p(x)
$$




































 



