# 状态空间方程的解





[TOC]

## 数学工具

有常微分方程
$$
\dot x(t) = a x_1(t)
\\
x_1(t) = x_1(0) e^{at}
$$
还有微分方程组，非耦合独立情况：
$$
\begin{cases}
\dot x_1(t) =   x_1(t) \\
\dot x_2(t) = -2 x_2(t) \\
\end{cases}
\Rightarrow
\begin{cases}
x_1(t)=x_1(0)e^{t} \\
x_2(t)=x_2(0)e^{-2t} 
\end{cases}
\\
\Rightarrow
\frac{d}{dx}
\begin{bmatrix}
x_1 \\
x_2 \\ 
\end{bmatrix}
=
A
\begin{bmatrix}
x_1 \\
x_2 \\ 
\end{bmatrix}
\\
\Rightarrow
\frac {d\vec x}{dt} = A \vec x
,
A = 
\begin{bmatrix}
1 & 0 \\
0 & -2 \\ 
\end{bmatrix}
$$
耦合情况：
$$
\begin{cases}
\dot x_1(t) =   x_1(t)+x_2(t) \\
\dot x_2(t) =4  x_1(t) -2 x_2(t) \\
\end{cases}
\Rightarrow
\begin{cases}
x_1(t)=? \\
x_2(t)=?
\end{cases}
\\
\Rightarrow
\frac{d}{dx}
\begin{bmatrix}
x_1 \\
x_2 \\ 
\end{bmatrix}
=
A
\begin{bmatrix}
x_1 \\
x_2 \\ 
\end{bmatrix}
\\
\Rightarrow
\frac {d\vec x}{dt} = A \vec x
,
A = 
\begin{bmatrix}
1 & 1 \\
4 & -2 \\ 
\end{bmatrix}
$$
此时需要求解则会出现指数矩阵
$$
假设有解：\vec x(t) = e^{At}\vec x(0)
\\
\vec x(t) =
\begin{bmatrix} 
x_1(t) \\
x_2(t) \\
... \\
\end{bmatrix}
\\
\vec x(0) =
\begin{bmatrix} 
x_1(0) \\
x_2(0) \\
... \\
\end{bmatrix}
\\
A 为一个矩阵
$$

$$
假设的解 \vec x(t) = e^{At}\vec x(0) 需要满足方程
\frac {d\vec x}{dt} = A \vec x
那么\\
\frac{d e^{At}}{dt} = Ae^{At}
$$



有泰勒级数
$$
e^{at} = 1+at+\frac1{2!}(at)^2+\frac1{3!}(at)^3 + ...
\\变为矩阵就是：\\
e^{At} = I+At+\frac1{2!}(At)^2+\frac1{3!}(At)^3 + ...
\\求导则有\\
\frac{d e^{At}}{dt} = 0 + A + A^2t +\frac1{2!}(At)^2 +\frac1{3!}(At)^3 + ...
\\那么右侧就是Ae^{At}，所以\\
\frac{d e^{At}}{dt} =Ae^{At}
$$

$$
e^{At}就是矩阵指数函数 
\\
若A =0 时：e^{At} = I +0 +0 +...
\\
若A为对角阵：
A = \Lambda = 
\begin{bmatrix}
\lambda_1 & 0 &\cdots& 0 \\
0 & \lambda_2 &\cdots & 0 \\
\vdots &\vdots& \ddots & \vdots \\ 
0 &0 & \cdots&\lambda_n 
\end{bmatrix}
\\
 \Lambda = 
\begin{bmatrix}
\lambda_1^n 	& 0 		&\cdots		& 0 \\
0 				&\lambda_2^n&\cdots 	& 0 \\
\vdots 			&\vdots		& \ddots 	& \vdots \\ 
0				&0 			&\cdots 		&\lambda_n^n 
\end{bmatrix}
\\
e^{\Lambda t} = I+\Lambda t+\frac1{2!}(\Lambda t)^2+\frac1{3!}( \Lambda t)^3 + ...
\\
= 
\begin{bmatrix}
1 & 0 &0&  0 \\
0 & 1 &0 & 0  \\
 \cdots & \cdots & \ddots &  \vdots  \\ 
 0 &  0  & \cdots    &1
\end{bmatrix}
+
\begin{bmatrix}
\lambda_1t & 0 &0&  0 \\
0 & \lambda_2t &0 & 0  \\
 \cdots & \cdots & \ddots &  \vdots  \\ 
 0 &  0  & \cdots    &\lambda_nt
\end{bmatrix}
+
\begin{bmatrix}
\frac1{2!}\lambda_1^2t^2 & 0 &0&  0 \\
0 & \frac1{2!}\lambda_2^2t^2 &0 & 0  \\
 \cdots & \cdots & \ddots &  \vdots  \\ 
 0 &  0  & \cdots    &\frac1{2!}\lambda_n^2t^2
\end{bmatrix}
+...
\\
=
\begin{bmatrix}
1+\lambda_1t+\frac1{2!}\lambda_1^2t^2& 0 						&0			&  0 \\
0 						& 1+\lambda_2t+\frac1{2!}\lambda_2^2t^2 	&0 			& 0  \\
 \cdots 				& \cdots 					& \ddots 	& \vdots  \\ 
 0 						&  0 			 			& \cdots    &1+\lambda_nt+\frac1{2!}\lambda_n^2t^2
\end{bmatrix}
 =
 \begin{bmatrix}
 e^{\lambda_1 t} & 0 &0&  0 \\
0 &  e^{\lambda_2 t} &0 & 0  \\
 \cdots & \cdots & \ddots &  \vdots  \\ 
 0 &  0  & \cdots    & e^{\lambda_n t}
 \end{bmatrix}
$$


补充 矩阵分解公式
$$
A = P \Lambda P^{-1}
\\
\Lambda =
\begin{bmatrix}
\lambda_1  & 0 &0&  0 \\
0 & \lambda_2  &0 & 0  \\
 \cdots & \cdots & \ddots &  \vdots  \\ 
 0 &  0  & \cdots    &\lambda_n 
\end{bmatrix}
,
\lambda_i是A的特征值
\\
P : 过度矩阵 P = \begin{bmatrix}v_1 & v_2 & ...  & v_n\end{bmatrix},v_i为A的特征向量
\\有推论:\\
A^2 =   P \Lambda P^{-1}  P \Lambda P^{-1} =   P \Lambda^2 P^{-1}
\\
A^3 =  P \Lambda^3 P^{-1}
$$
故回到原有内容的解耦方法
$$
A = P \Lambda P^{-1}
\\
e^{At} = I+At+\frac1{2!}(At)^2+\frac1{3!}(At)^3 + ... \\
=  I+ P \Lambda P^{-1}t+\frac1{2!} P \Lambda^2 P^{-1} t+\frac1{3!}P \Lambda^3 P^{-1} t + ... 
\\
对上式两侧乘P^{-1}和 P
\\
-------------------
\\
P^{-1}e^{At}P 
=P^{-1}(I+At+\frac1{2!}(At)^2+\frac1{3!}(At)^3 + ...)P \\
=P^{-1}( I+ P \Lambda P^{-1}t+\frac1{2!} P \Lambda^2 P^{-1} t+\frac1{3!}P \Lambda^3 P^{-1} t + ... )P\\
=I+  \Lambda  t+\frac1{2!} \Lambda^2  t +\frac1{3!}  \Lambda^3  t+ ... 
=e^{\Lambda t}
\\故\\
P^{-1} e^{At} P =e^{\Lambda t} \Rightarrow  e^{A t}= Pe^{\Lambda t}P^{-1}
$$


## 状态空间的解

那么接下来求状态空间表达
$$
\frac{d\vec x(t)}{dt} = A\vec x(t) + B \vec u(t)
\\两边同乘e^{-At}\\
e^{-At}\frac{d\vec x(t)}{dt} =A e^{-At}\vec x(t) + B e^{-At}\vec u(t)
 \\ \to 
e^{-At}\frac{d\vec x(t)}{dt} -A e^{-At}\vec x(t)=   B e^{-At}\vec u(t)
\\ \to
\frac{d[e^{At}\vec x(t)]}{dt} =   B e^{-At}\vec u(t)
\\ \to
\int_{t_0}^t\frac{d[e^{At}\vec x(t)]}{dt} = \int_{t_0}^t  B e^{-At}\vec u(t) 
\\ \to 
e^{-At} \vec x(\tau) | _{t_0}^t = \int_{t_0}^t  B e^{-A\tau}\vec u(\tau) d\tau
\\ \to 
\vec x(\tau)  = e ^{A(t-t_0)}\vec x(t_0) + \int_{t_0}^t   e^{-A\tau}B\vec u(\tau) d\tau
\\
 e ^{A(t-t_0)} 为状态转移矩阵，A 特征值的实部都小于0 则系统区域稳定
 \\
 第二项为卷积，表达输入和输出的关系
 \\一般写为\\
\vec x(\tau) = \Phi(t-t_0)\vec x(t_0) + \int_{t_0}^t \Phi(t-\tau) B\vec u(\tau) d\tau
 
$$
















































